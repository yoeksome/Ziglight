///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.10.3.10338/W32 for 8051        06/Jun/2017  15:23:34 /
// Copyright 2004-2011 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//    Source file        =  E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\Source\gizwits_product.c        /
//    Command line       =  -f E:\work\smartlight\ZigLight001\Projects\zstack /
//                          \Samples\ZigLightApp\CC2530DB\..\..\..\Tools\CC25 /
//                          30DB\f8wRouter.cfg (-DCPU32MHZ                    /
//                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TR /
//                          UE -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8     /
//                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f                  /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\Tools\CC2530D /
//                          B\f8wConfig.cfg (-DZIGBEEPRO -DSECURE=0           /
//                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                 /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFF00                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DLINK_STATUS_JITTER_MASK=0x007F                  /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const    /
//                          __code" -DGENERIC=__generic                       /
//                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000       /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)  /
//                          -DREJOIN_POLL_RATE=440 E:\work\smartlight\ZigLigh /
//                          t001\Projects\zstack\Samples\ZigLightApp\Source\g /
//                          izwits_product.c -D ZTOOL_P1 -D MT_TASK -D        /
//                          MT_SYS_FUNC -D MT_ZDO_FUNC -D                     /
//                          xLCD_SUPPORTED=DEBUG -D MT_ZDO_MGMT -lC           /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\RouterEB\List\ -lA     /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\RouterEB\List\         /
//                          --diag_suppress Pe001,Pa010 -o                    /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\RouterEB\Obj\ -e       /
//                          --no_code_motion --debug --core=plain             /
//                          --dptr=16,1 --data_model=large                    /
//                          --code_model=banked --calling_convention=xdata_re /
//                          entrant --place_constants=data_rom                /
//                          --nr_virtual_regs 16 -I                           /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\ -I                    /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\Source\ -I          /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\ZMain\TI2530D /
//                          B\ -I E:\work\smartlight\ZigLight001\Projects\zst /
//                          ack\Samples\ZigLightApp\CC2530DB\..\..\..\..\..\C /
//                          omponents\hal\include\ -I                         /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\hal\target\CC2530EB\ -I                       /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\mac\include\ -I E:\work\smartlight\ZigLight00 /
//                          1\Projects\zstack\Samples\ZigLightApp\CC2530DB\.. /
//                          \..\..\..\..\Components\mac\high_level\ -I        /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\mac\low_level\srf04\ -I                       /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\mac\low_level\srf04\single_chip\ -I           /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\mt\ -I E:\work\smartlight\ZigLight001\Project /
//                          s\zstack\Samples\ZigLightApp\CC2530DB\..\..\..\.. /
//                          \..\Components\osal\include\ -I                   /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\services\saddr\ -I E:\work\smartlight\ZigLigh /
//                          t001\Projects\zstack\Samples\ZigLightApp\CC2530DB /
//                          \..\..\..\..\..\Components\services\sdata\ -I     /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\stack\af\ -I E:\work\smartlight\ZigLight001\P /
//                          rojects\zstack\Samples\ZigLightApp\CC2530DB\..\.. /
//                          \..\..\..\Components\stack\nwk\ -I                /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\stack\sapi\ -I E:\work\smartlight\ZigLight001 /
//                          \Projects\zstack\Samples\ZigLightApp\CC2530DB\..\ /
//                          ..\..\..\..\Components\stack\sec\ -I              /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\stack\sys\ -I E:\work\smartlight\ZigLight001\ /
//                          Projects\zstack\Samples\ZigLightApp\CC2530DB\..\. /
//                          .\..\..\..\Components\stack\zdo\ -I               /
//                          E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\zmac\ -I E:\work\smartlight\ZigLight001\Proje /
//                          cts\zstack\Samples\ZigLightApp\CC2530DB\..\..\..\ /
//                          ..\..\Components\zmac\f8w\ -Ohz                   /
//                          --require_prototypes                              /
//    List file          =  E:\work\smartlight\ZigLight001\Projects\zstack\Sa /
//                          mples\ZigLightApp\CC2530DB\RouterEB\List\gizwits_ /
//                          product.s51                                       /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME gizwits_product

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?L_ADD_X
        EXTERN ?L_MOV_X
        EXTERN ?PUSH_XSTACK8_X_FOUR
        EXTERN ?PUSH_XSTACK_I_THREE
        EXTERN ?UL_GE_X
        EXTERN ?UL_GT
        EXTERN ?V0
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN __INIT_XDATA_Z

        PUBLIC ??UART_IRQ_FUN?relay
        FUNCTION ??UART_IRQ_FUN?relay,0203H
        PUBLIC ??gizGetTimerCount?relay
        FUNCTION ??gizGetTimerCount?relay,0203H
        PUBLIC ??gizwitsEventProcess?relay
        FUNCTION ??gizwitsEventProcess?relay,0203H
        PUBLIC ??mcuRestart?relay
        FUNCTION ??mcuRestart?relay,0203H
        PUBLIC ??uartWrite?relay
        FUNCTION ??uartWrite?relay,0203H
        PUBLIC AutoUpateMac
        PUBLIC MacToAppFlag
        PUBLIC UART_IRQ_FUN
        FUNCTION UART_IRQ_FUN,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 5, STACK
        PUBWEAK __Constant_0
        PUBWEAK __Constant_1
        PUBWEAK __Constant_2
        PUBLIC gizGetTimerCount
        FUNCTION gizGetTimerCount,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC gizwitsEventProcess
        FUNCTION gizwitsEventProcess,021203H
        ARGFRAME XSTACK, 4, STACK
        LOCFRAME XSTACK, 23, STACK
        PUBLIC mcuRestart
        FUNCTION mcuRestart,0203H
        ARGFRAME XSTACK, 0, STACK
        PUBLIC uartWrite
        FUNCTION uartWrite,021203H
        ARGFRAME XSTACK, 4, STACK
        LOCFRAME XSTACK, 21, STACK
        
        CFI Names cfiNames0
        CFI StackFrame CFA_SP SP IDATA
        CFI StackFrame CFA_PSP16 PSP16 XDATA
        CFI StackFrame CFA_XSP16 XSP16 XDATA
        CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
        CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
        CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
        CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
        CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
        CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
        CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
        CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
        CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
        CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
        CFI VirtualResource ?RET:24
        CFI Resource ?BRET_EXT:8
        CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
        CFI ResourceParts PSP16 PSPH, PSPL
        CFI ResourceParts XSP16 XSPH, XSPL
        CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
        CFI EndNames cfiNames0
        
        CFI Common cfiCommon0 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-3
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B Undefined
        CFI A Undefined
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 Undefined
        CFI R1 Undefined
        CFI R2 Undefined
        CFI R3 Undefined
        CFI R4 Undefined
        CFI R5 Undefined
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI V8 SameValue
        CFI V9 SameValue
        CFI V10 SameValue
        CFI V11 SameValue
        CFI V12 SameValue
        CFI V13 SameValue
        CFI V14 SameValue
        CFI V15 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT Frame(CFA_SP, 3)
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon0
        
osal_msg_allocate   SYMBOL "osal_msg_allocate"
osal_memcpy         SYMBOL "osal_memcpy"
osal_msg_send       SYMBOL "osal_msg_send"
osal_GetSystemClock SYMBOL "osal_GetSystemClock"
gizPutData          SYMBOL "gizPutData"
HalUARTWrite        SYMBOL "HalUARTWrite"
??HalUARTWrite?relay SYMBOL "?relay", HalUARTWrite
??gizPutData?relay  SYMBOL "?relay", gizPutData
??osal_GetSystemClock?relay SYMBOL "?relay", osal_GetSystemClock
??osal_memcpy?relay SYMBOL "?relay", osal_memcpy
??osal_msg_allocate?relay SYMBOL "?relay", osal_msg_allocate
??osal_msg_send?relay SYMBOL "?relay", osal_msg_send
UART_IRQ_FUN        SYMBOL "UART_IRQ_FUN"
??UART_IRQ_FUN?relay SYMBOL "?relay", UART_IRQ_FUN
gizGetTimerCount    SYMBOL "gizGetTimerCount"
??gizGetTimerCount?relay SYMBOL "?relay", gizGetTimerCount
gizwitsEventProcess SYMBOL "gizwitsEventProcess"
??gizwitsEventProcess?relay SYMBOL "?relay", gizwitsEventProcess
mcuRestart          SYMBOL "mcuRestart"
??mcuRestart?relay  SYMBOL "?relay", mcuRestart
uartWrite           SYMBOL "uartWrite"
??uartWrite?relay   SYMBOL "?relay", uartWrite

        EXTERN osal_msg_allocate
        FUNCTION osal_msg_allocate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_send
        FUNCTION osal_msg_send,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_GetSystemClock
        FUNCTION osal_GetSystemClock,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN gizPutData
        FUNCTION gizPutData,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 5, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalUARTWrite
        FUNCTION HalUARTWrite,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ??HalUARTWrite?relay
        FUNCTION ??HalUARTWrite?relay,00H
        EXTERN ??gizPutData?relay
        FUNCTION ??gizPutData?relay,00H
        EXTERN ??osal_GetSystemClock?relay
        FUNCTION ??osal_GetSystemClock?relay,00H
        EXTERN ??osal_memcpy?relay
        FUNCTION ??osal_memcpy?relay,00H
        EXTERN ??osal_msg_allocate?relay
        FUNCTION ??osal_msg_allocate?relay,00H
        EXTERN ??osal_msg_send?relay
        FUNCTION ??osal_msg_send?relay,00H
        EXTERN ZigLightApp_TaskID
        EXTERN currentDataPoint

// E:\work\smartlight\ZigLight001\Projects\zstack\Samples\ZigLightApp\Source\gizwits_product.c
//    1 /**
//    2 ************************************************************
//    3 * @file         gizwits_product.c
//    4 * @brief        Gizwits ÊéßÂà∂ÂçèËÆÆÂ§ÑÁêÜ,ÂèäÂπ≥Âè∞Áõ∏ÂÖ≥ÁöÑÁ°¨‰ª∂ÂàùÂßãÂå?
//    5 * @author       Gizwits
//    6 * @date         2016-09-05
//    7 * @version      V03010101
//    8 * @copyright    Gizwits
//    9 * 
//   10 * @note         Êú∫Êô∫‰∫?Âè™‰∏∫Êô∫ËÉΩÁ°¨‰ª∂ËÄåÁîü
//   11 *               Gizwits Smart Cloud  for Smart Products
//   12 *               ÈìæÊé•|Â¢ûÂÄº÷µ|ÂºÄÊîæ|‰∏≠Á´ã|ÂÆâÂÖ®|Ëá™Êúâ|Ëá™Áî±|ÁîüÊÄ?*               www.gizwits.com
//   13 *
//   14 ***********************************************************/
//   15 
//   16 #include <stdio.h>
//   17 #include <string.h>
//   18 #include "gizwits_protocol.h"
//   19 #include "List1.h"
//   20 #define SERIAL_INCOMING_MSG                  0xE1//by liu
//   21 int8 gizwitsEventProcess(eventInfo_t *info, uint8 *data, uint32 len);//by liu
//   22 void gizTimerMs(void);//by liu
//   23 uint32 gizGetTimerCount(void);//by liu
//   24 void TIMER_IRQ_FUN(void);//by liu
//   25 void UART_IRQ_FUN(void);//by liu
//   26 extern uint16 HalUARTWrite(uint8 port, uint8 *buf, uint16 len);//by liu

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   27 uint8 MacToAppFlag = 0;//by liu
MacToAppFlag:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   28 uint8 AutoUpateMac = 0;//by liu
AutoUpateMac:
        DS 1
        REQUIRE __INIT_XDATA_Z
//   29 extern Node *nodelist;//by liu
//   30 extern uint8 ZigLightApp_TaskID;
//   31 typedef struct
//   32 {
//   33   osal_event_hdr_t  hdr;
//   34   uint8             *msg;
//   35 } gizOSALData_t;
//   36 /**@} */
//   37 /**@name Gizwits Áî®Êà∑APIÊé•Âè£
//   38 * @{
//   39 */
//   40 extern dataPoint_t currentDataPoint;
//   41 
//   42 /**
//   43 * @brief ‰∫ã‰ª∂Â§ÑÁêÜÊé•Âè£
//   44 
//   45 * ËØ¥ÊòéÔº?
//   46 * 1.Áî®Êà∑ÂèØ‰ª•ÂØπWiFiÊ®°ÁªÑÁä∂ÊÄÅÁöÑÂèòÂåñËøõË°åËá™ÂÆö‰πâÁöÑÂ§ÑÁêÜ
//   47 
//   48 * 2.Áî®Êà∑ÂèØ‰ª•Âú®ËØ•ÂáΩÊï∞ÂÜÖÊ∑ªÂä†Êï∞ÊçÆÁÇπ‰∫ã‰ª∂Â§ÑÁêÜÈÄªËæëÔºåÂ¶ÇË∞ÉÁî®Áõ∏ÂÖ≥Á°¨‰ª∂Â§ñËÆæÁöÑÊìç‰ΩúÊé•Âè?
//   49 * @param[in] info : ‰∫ã‰ª∂ÈòüÂàó
//   50 * @param[in] data : ÂçèËÆÆÊï∞ÊçÆ
//   51 * @param[in] len : ÂçèËÆÆÊï∞ÊçÆÈïøÂ∫¶
//   52 * @return NULL
//   53 * @ref gizwits_protocol.h
//   54 */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   55 int8 gizwitsEventProcess(eventInfo_t *info, uint8 *data, uint32 len)
gizwitsEventProcess:
        CFI Block cfiBlock0 Using cfiCommon0
        CFI Function gizwitsEventProcess
        CODE
//   56 {
        FUNCALL gizwitsEventProcess, osal_msg_allocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL gizwitsEventProcess, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL gizwitsEventProcess, osal_msg_send
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL gizwitsEventProcess, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x14
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 20)
        ; Saved register size: 20
        ; Auto size: 0
        MOV     ?V0 + 8,R2
        MOV     ?V0 + 9,R3
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
//   57   uint8 i = 0;
//   58   dataPoint_t *dataPointPtr = (dataPoint_t *)data;
//   59   moduleStatusInfo_t *wifiData = (moduleStatusInfo_t *)data;
//   60   protocolTime_t *ptime = (protocolTime_t *)data;
//   61   static Node * nodeptr=NULL;
//   62   static uint8 sn = 0;
//   63   uint8 pos;
//   64   gizOSALData_t  *pMsg;
//   65   if((NULL == info) || (NULL == data))
        MOV     A,R2
        ORL     A,?V0 + 9
        JZ      ??gizwitsEventProcess_0
        MOV     A,R4
        ORL     A,?V0 + 1
        JNZ     ??gizwitsEventProcess_1
//   66   {
//   67     return -1;
??gizwitsEventProcess_0:
        MOV     R1,#-0x1
        LJMP    ??gizwitsEventProcess_2 & 0xFFFF
//   68   }
//   69 
//   70   for(i=0; i<info->num; i++)
??gizwitsEventProcess_1:
        MOV     ?V0 + 2,#0x0
        SJMP    ??gizwitsEventProcess_3
//   71   {
//   72     switch(info->event[i])
//   73     {
//   74 
//   75 
//   76 
//   77       case EVENT_AA1:
//   78         GIZWITS_LOG("Evt: EVENT_AA1\n");
//   79         osal_memcpy((uint8 *)&currentDataPoint.valueaa1,"AutoUpdate DeviceMac",20);
//   80         //user handle
//   81         switch(dataPointPtr->valueaa1[0])
//   82         {
//   83         case 0x01://«Î«Û…Ë±∏
//   84           MacToAppFlag = 1;
//   85 //          if(nodeptr == NULL){
//   86 //            MacToAppFlag = 1;
//   87 //            nodeptr = nodelist;
//   88 //            sn = dataPointPtr->valueaa1[1];
//   89 //            for(i=0;i<20;i++)
//   90 //              currentDataPoint.valueaa1[i]=0;
//   91 //          }
//   92 //          for(pos=0;nodeptr&&pos<=1;nodeptr=nodeptr->next,pos++)
//   93 //          {
//   94 //            osal_memcpy((uint8 *)&currentDataPoint.valueaa1[3+8*pos],(uint8 *)&nodeptr->extaddr, 8);
//   95 //          }
//   96 //          if(nodeptr == NULL){
//   97 //            MacToAppFlag = 0;
//   98 //          }
//   99 //          currentDataPoint.valueaa1[0]=0x10;
//  100 //          currentDataPoint.valueaa1[1]=pos;
//  101 //          currentDataPoint.valueaa1[2]=sn;
//  102           break;
//  103         case 0x02://øÿ÷∆√¸¡Ó
//  104           /* Allocate memory for the data */
//  105           pMsg = (gizOSALData_t *)osal_msg_allocate( sizeof ( gizOSALData_t ) + 14 );
??gizwitsEventProcess_4:
        ; Setup parameters for call to function osal_msg_allocate
        MOV     R2,#0x12
        MOV     R3,#0x0
        LCALL   ??osal_msg_allocate?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     R6,?V0 + 4
        MOV     R7,?V0 + 5
//  106           pMsg->hdr.event = SERIAL_INCOMING_MSG;
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,#-0x1f
        MOVX    @DPTR,A
//  107           pMsg->msg = (uint8*)(pMsg+1);
        MOV     A,R6
        ADD     A,#0x2
        MOV     R0,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     ?V0 + 10,R0
        MOV     ?V0 + 11,R1
        MOV     A,R6
        ADD     A,#0x4
        INC     R0
        INC     R0
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,?V0 + 10
        MOV     DPH,?V0 + 11
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  108           osal_memcpy((uint8 *)pMsg->msg,(uint8 *)&dataPointPtr->valueaa1[2], 14);
        ; Setup parameters for call to function osal_memcpy
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOV     R1,DPL
        MOV     R2,DPH
        MOV     ?V0 + 4,R1
        MOV     ?V0 + 5,R2
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0xe
        MOV     R5,#0x0
        MOV     DPL,?V0 + 10
        MOV     DPH,?V0 + 11
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 20)
//  109           osal_msg_send( ZigLightApp_TaskID, (byte *)pMsg );
        ; Setup parameters for call to function osal_msg_send
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     DPTR,#ZigLightApp_TaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_msg_send?relay
//  110           break;
??gizwitsEventProcess_5:
        INC     ?V0 + 2
??gizwitsEventProcess_3:
        MOV     DPL,?V0 + 8
        MOV     DPH,?V0 + 9
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,?V0 + 2
        CLR     C
        SUBB    A,R0
        JNC     ??gizwitsEventProcess_6
        MOV     ?V0 + 4,?V0 + 2
        MOV     A,?V0 + 8
        ADD     A,?V0 + 4
        MOV     DPL,A
        MOV     A,?V0 + 9
        ADDC    A,#0x0
        MOV     DPH,A
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x10
        JNZ     ??gizwitsEventProcess_5
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 4,#`?<Constant "AutoUpdate DeviceMac">` & 0xff
        MOV     ?V0 + 5,#(`?<Constant "AutoUpdate DeviceMac">` >> 8) & 0xff
        MOV     ?V0 + 6,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x14
        MOV     R5,#0x0
        MOV     R2,#currentDataPoint & 0xff
        MOV     R3,#(currentDataPoint >> 8) & 0xff
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 20)
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    A,@DPTR
        DEC     A
        JZ      ??gizwitsEventProcess_7
        DEC     A
        JNZ     $+5
        LJMP    ??gizwitsEventProcess_4 & 0xFFFF
        SJMP    ??gizwitsEventProcess_5
??gizwitsEventProcess_7:
        MOV     DPTR,#MacToAppFlag
        MOV     A,#0x1
        MOVX    @DPTR,A
        SJMP    ??gizwitsEventProcess_5
//  111         default:
//  112           break;
//  113         }
//  114         
//  115         break;
//  116 
//  117       case WIFI_SOFTAP:
//  118         break;
//  119       case WIFI_AIRLINK:
//  120         break;
//  121       case WIFI_STATION:
//  122         break;
//  123       case WIFI_CON_ROUTER:
//  124         break;
//  125       case WIFI_DISCON_ROUTER:
//  126         break;
//  127       case WIFI_CON_M2M:
//  128         break;
//  129       case WIFI_DISCON_M2M:
//  130         break;
//  131       case WIFI_RSSI:
//  132         GIZWITS_LOG("RSSI %d\n", wifiData->rssi);
//  133         break;
//  134       case TRANSPARENT_DATA:
//  135         GIZWITS_LOG("TRANSPARENT_DATA \n");
//  136         //user handle , Fetch data from [data] , size is [len]
//  137         break;
//  138       case WIFI_NTP:
//  139         GIZWITS_LOG("WIFI_NTP : [%d-%d-%d %02d:%02d:%02d][%d] \n",ptime->year,ptime->month,ptime->day,ptime->hour,ptime->minute,ptime->second,ptime->ntp);
//  140         break;
//  141       default:
//  142         break;
//  143     }
//  144   }
//  145 
//  146   return 0;
??gizwitsEventProcess_6:
        MOV     R1,#0x0
        CFI EndBlock cfiBlock0
??gizwitsEventProcess_2:
        REQUIRE ?Subroutine0
        ; // Fall through to label ?Subroutine0
//  147 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine0:
        CFI Block cfiBlock1 Using cfiCommon0
        CFI NoFunction
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 20)
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0xc
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock1
//  148 
//  149 
//  150 /**@} */
//  151 
//  152 /**
//  153 * @brief MCUÂ§ç‰ΩçÂáΩÊï∞
//  154 
//  155 * @param none
//  156 * @return none
//  157 */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  158 void mcuRestart(void)
mcuRestart:
        CFI Block cfiBlock2 Using cfiCommon0
        CFI Function mcuRestart
        CODE
//  159 {
        ; Saved register size: 0
        ; Auto size: 0
//  160 
//  161 }
        LJMP    ?BRET
        CFI EndBlock cfiBlock2
//  162 
//  163 /**@} */
//  164 /**
//  165 * @brief Á≥ªÁªüÊØ´ÁßíËÆ°Êó∂Áª¥Êä§ÂáΩÊï∞,ÊØ´ÁßíËá™Â¢û,Ê∫¢Âá∫ÂΩíÈõ∂
//  166 
//  167 * @param none
//  168 * @return none
//  169 */
//  170 //static uint32 timerMsCount;
//  171 //void gizTimerMs(void)
//  172 //{
//  173 //    timerMsCount++;
//  174 //}
//  175 
//  176 /**
//  177 * @brief ËØªÂèñÁ≥ªÁªüÊó∂Èó¥ÊØ´ÁßíËÆ°Êó∂Êï?
//  178 * @param none
//  179 * @return Á≥ªÁªüÊó∂Èó¥ÊØ´ÁßíÊï?*/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  180 uint32 gizGetTimerCount(void)
gizGetTimerCount:
        CFI Block cfiBlock3 Using cfiCommon0
        CFI Function gizGetTimerCount
        CODE
//  181 {
        FUNCALL gizGetTimerCount, osal_GetSystemClock
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  182     return osal_GetSystemClock();
        ; Setup parameters for call to function osal_GetSystemClock
        LCALL   ??osal_GetSystemClock?relay
        CFI EndBlock cfiBlock3
        REQUIRE ?Subroutine1
        ; // Fall through to label ?Subroutine1
//  183 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine1:
        CFI Block cfiBlock4 Using cfiCommon0
        CFI NoFunction
        CFI CFA_SP SP+-5
        CFI DPL0 Frame(CFA_SP, 4)
        CFI DPH0 Frame(CFA_SP, 5)
        POP     DPH
        CFI CFA_SP SP+-4
        CFI DPH0 SameValue
        POP     DPL
        CFI CFA_SP SP+-3
        CFI DPL0 SameValue
        LJMP    ?BRET
        CFI EndBlock cfiBlock4
//  184 
//  185 /**
//  186 * @brief ÂÆöÊó∂Âô®TIM3‰∏≠Êñ≠Â§ÑÁêÜÂáΩÊï∞
//  187 
//  188 * @param none
//  189 * @return none
//  190 */
//  191 //void TIMER_IRQ_FUN(void)
//  192 //{
//  193 //  gizTimerMs();
//  194 //}
//  195 
//  196 /**
//  197 * @brief USART2‰∏≤Âè£‰∏≠Êñ≠ÂáΩÊï∞
//  198 
//  199 * Êé•Êî∂ÂäüËÉΩÔºåÁî®‰∫éÊé•Êî∂‰∏éWiFiÊ®°ÁªÑÈó¥ÁöÑ‰∏≤Âè£ÂçèËÆÆÊï∞ÊçÆ
//  200 * @param none
//  201 * @return none
//  202 */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  203 void UART_IRQ_FUN(void)
UART_IRQ_FUN:
        CFI Block cfiBlock5 Using cfiCommon0
        CFI Function UART_IRQ_FUN
        CODE
//  204 {
        FUNCALL UART_IRQ_FUN, gizPutData
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 5, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 5, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 1)
//  205   uint8 value = 0;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
//  206   //value = USART_ReceiveData(USART2);//STM32 test demo
//  207   gizPutData(&value, 1);
        ; Setup parameters for call to function gizPutData
        MOV     DPTR,#__Constant_1
        LCALL   ?PUSH_XSTACK8_X_FOUR
        CFI CFA_XSP16 add(XSP16, 5)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??gizPutData?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 1)
//  208 }
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 XSP16+0
        SJMP    ?Subroutine1
        CFI EndBlock cfiBlock5
//  209 
//  210 
//  211 /**
//  212 * @brief ‰∏≤Âè£ÂÜôÊìç‰ΩúÔºåÂèëÈÄÅÊï∞ÊçÆÂà∞WiFiÊ®°ÁªÑ
//  213 *
//  214 * @param buf      : Êï∞ÊçÆÂú∞ÂùÄ
//  215 * @param len       : Êï∞ÊçÆÈïøÂ∫¶
//  216 *
//  217 * @return : Ê≠£Á°ÆËøîÂõûÊúâÊïàÊï∞ÊçÆÈïøÂ∫¶;-1ÔºåÈîôËØØËøîÂõ?*/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  218 uint32 uartWrite(uint8 *buf, uint32 len)
uartWrite:
        CFI Block cfiBlock6 Using cfiCommon0
        CFI Function uartWrite
        CODE
//  219 {
        FUNCALL uartWrite, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL uartWrite, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x14
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 20)
        ; Saved register size: 20
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 21)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
        MOV     A,#0x15
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
//  220     uint32 i = 0;
//  221     uint8 appendex=0x55;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x55
        MOVX    @DPTR,A
//  222     if(NULL == buf || len == 0)
        MOV     A,R6
        ORL     A,R7
        JZ      ??uartWrite_0
        MOV     A,?V0 + 4
        ORL     A,?V0 + 5
        ORL     A,?V0 + 6
        ORL     A,?V0 + 7
        JNZ     ??uartWrite_1
//  223     {
//  224         return 0;
??uartWrite_0:
        MOV     R2,#0x0
        MOV     R3,#0x0
        MOV     R4,#0x0
        MOV     R5,#0x0
        SJMP    ??uartWrite_2
//  225     }
//  226 #ifdef PROTOCOL_DEBUG
//  227     GIZWITS_LOG("MCU2WiFi[%4d:%4d]: ", gizGetTimerCount(), len);
//  228 #endif
//  229     
//  230     for(i=0; i<len; i++)
??uartWrite_1:
        MOV     DPTR,#__Constant_0
        MOV     R0,#?V0 + 8
        LCALL   ?L_MOV_X
//  231     {
//  232         //USART_SendData(UART, buf[i]);//STM32 test demo
//  233         //ÂÆûÁé∞‰∏≤Âè£ÂèëÈÄÅÂáΩÊï?Â∞Übuf[i]ÂèëÈÄÅÂà∞Ê®°ÁªÑ
//  234       HalUARTWrite(0,&buf[i],1);
??uartWrite_3:
        ; Setup parameters for call to function HalUARTWrite
        MOV     R4,#0x1
        MOV     R5,#0x0
        MOV     ?V0 + 0,?V0 + 8
        MOV     ?V0 + 1,?V0 + 9
        MOV     A,R6
        ADD     A,?V0 + 0
        MOV     R2,A
        MOV     A,R7
        ADDC    A,?V0 + 1
        MOV     R3,A
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
//  235 #ifdef PROTOCOL_DEBUG
//  236         GIZWITS_LOG("%02x ", buf[i]);
//  237 #endif
//  238         if(i >=2 && buf[i] == 0xFF)
        MOV     DPTR,#__Constant_2
        MOV     R0,#?V0 + 8
        LCALL   ?UL_GE_X
        JNC     ??uartWrite_4
        MOV     A,R6
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,?V0 + 1
        MOV     DPH,A
        MOVX    A,@DPTR
        CPL     A
        JNZ     ??uartWrite_4
//  239         {
//  240           //ÂÆûÁé∞‰∏≤Âè£ÂèëÈÄÅÂáΩÊï?Â∞?x55ÂèëÈÄÅÂà∞Ê®°ÁªÑ
//  241           HalUARTWrite(0,&appendex,1);
        ; Setup parameters for call to function HalUARTWrite
        MOV     R4,#0x1
        MOV     R5,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
//  242 #ifdef PROTOCOL_DEBUG
//  243         GIZWITS_LOG("%02x ", 0x55);
//  244 #endif
//  245         }
//  246     }
??uartWrite_4:
        MOV     DPTR,#__Constant_1
        MOV     R0,#?V0 + 8
        LCALL   ?L_ADD_X
        MOV     R0,#?V0 + 4
        MOV     R1,#?V0 + 8
        LCALL   ?UL_GT
        JC      ??uartWrite_3
//  247     
//  248 #ifdef PROTOCOL_DEBUG
//  249     GIZWITS_LOG("\n");
//  250 #endif
//  251     
//  252     return len;
        MOV     R2,?V0 + 4
        MOV     R3,?V0 + 5
        MOV     R4,?V0 + 6
        MOV     R5,?V0 + 7
??uartWrite_2:
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 20)
        LJMP    ?Subroutine0 & 0xFFFF
        CFI EndBlock cfiBlock6
//  253 }

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??gizwitsEventProcess?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    gizwitsEventProcess

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??mcuRestart?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    mcuRestart

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??gizGetTimerCount?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    gizGetTimerCount

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??UART_IRQ_FUN?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    UART_IRQ_FUN

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??uartWrite?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    uartWrite

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "AutoUpdate DeviceMac">`:
        DB "AutoUpdate DeviceMac"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_1:
        DD 1

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_0:
        DD 0

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_2:
        DD 2

        END
//  254 
//  255 
// 
// 471 bytes in segment BANKED_CODE
//  30 bytes in segment BANK_RELAYS
//  33 bytes in segment XDATA_ROM_C
//   2 bytes in segment XDATA_Z
// 
// 501 bytes of CODE  memory
//  21 bytes of CONST memory (+ 12 bytes shared)
//   2 bytes of XDATA memory
//
//Errors: none
//Warnings: 5
